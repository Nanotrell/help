<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="container">
    <h1><i>Как справиться с булимией</i></h1>
    <p style="font-size: 26px;">Симптомы голода: 
        <li><i>урчание в животе</i></li>
        <li><i>ощущение пустоты в желудке</i></li>
        <li>озабоченность едой</li>
        <li>плохая концентрация</li>
        <li>раздражительность, если приём пищи откладывается</li></p>

    <div class="play" draggable="true" id="rotate">
        <div class="k1" style="transform: rotate(30deg);"></div>
        <div class="k1" style="transform: rotate(60deg);"></div>
        <div class="k1" style="transform: rotate(90deg);"></div>
        <div class="k1" style="transform: rotate(120deg);"></div>
        <div class="k1" style="transform: rotate(150deg);"></div>
        <div class="k" style="transform: rotate(30deg);"></div>
        <div class="k" style="transform: rotate(60deg);"></div>
        <div class="k" style="transform: rotate(90deg);"></div>
        <div class="k" style="transform: rotate(120deg);"></div>
        <div class="k" style="transform: rotate(150deg);"></div>
        <div class="k2" style="transform: rotate(30deg);"></div>
        <div class="k2" style="transform: rotate(60deg);"></div>
        <div class="k2" style="transform: rotate(90deg);"></div>
        <div class="k2" style="transform: rotate(120deg);"></div>
        <div class="k2" style="transform: rotate(150deg);"></div>
        <div class="k3" style="transform: rotate(30deg);"></div>
        <div class="k3" style="transform: rotate(60deg);"></div>
        <div class="k3" style="transform: rotate(90deg);"></div>
        <div class="k3" style="transform: rotate(120deg);"></div>
        <div class="k3" style="transform: rotate(150deg);"></div>
    </div>
</body>
<style>
  #rotate {
    margin: 50px auto;
      background: radial-gradient(#c24343, #fff);
    touch-action: none;
    user-select: none;
  }
  .active {
    border-radius: 100%;
  }
</style>

<div id="rotate"></div>

<script>
  (function() {
    const rot = document.getElementById('rotate');
    let angle = 0;
    let startAngle = 0;
    let isRotating = false;
    let center = { x: 0, y: 0 };

    // Функция для вычисления угла между центром элемента и точкой касания/клика
    function getAngle(centerX, centerY, pointX, pointY) {
      const dx = pointX - centerX;
      const dy = pointY - centerY;
      return Math.atan2(dy, dx) * (180 / Math.PI);
    }

    // Обработчик начала вращения
    function startRotate(e) {
      e.preventDefault();
      isRotating = true;
      
      // Получаем координаты центра элемента
      const rect = rot.getBoundingClientRect();
      center.x = rect.left + rect.width / 2;
      center.y = rect.top + rect.height / 2;
      
      // Получаем координаты начальной точки
      const pointX = e.clientX || e.touches[0].clientX;
      const pointY = e.clientY || e.touches[0].clientY;
      
      // Вычисляем начальный угол
      startAngle = getAngle(center.x, center.y, pointX, pointY) - angle;
      
      // Добавляем класс active
      rot.classList.add('active');
    }

    // Обработчик вращения
    function doRotate(e) {
      if (!isRotating) return;
      e.preventDefault();
      
      // Получаем координаты текущей точки
      const pointX = e.clientX || e.touches[0].clientX;
      const pointY = e.clientY || e.touches[0].clientY;
      
      // Вычисляем новый угол
      const newAngle = getAngle(center.x, center.y, pointX, pointY) - startAngle;
      
      // Применяем вращение
      angle = newAngle;
      rot.style.transform = `rotate(${angle}deg)`;
    }

    // Обработчик окончания вращения
    function stopRotate(e) {
      if (!isRotating) return;
      e.preventDefault();
      isRotating = false;
      rot.classList.remove('active');
      console.log('Final angle:', angle);
    }

    // Добавляем обработчики для мыши
    rot.addEventListener('mousedown', startRotate);
    document.addEventListener('mousemove', doRotate);
    document.addEventListener('mouseup', stopRotate);

    // Добавляем обработчики для сенсорных устройств
    rot.addEventListener('touchstart', startRotate, { passive: false });
    document.addEventListener('touchmove', doRotate, { passive: false });
    document.addEventListener('touchend', stopRotate, { passive: false });

    // Предотвращаем стандартное поведение браузера для touch-событий
    document.addEventListener('touchstart', (e) => {
      if (e.target === rot) e.preventDefault();
    }, { passive: false });

    document.addEventListener('touchmove', (e) => {
      if (isRotating) e.preventDefault();
    }, { passive: false });
  })();
</script>
</html>